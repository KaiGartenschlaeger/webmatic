
var webmaticVersion="0";var isPreRelease=0;var lastStableVersion="0";var newWebmaticVersion=webmaticVersion;var storageVersion=29;var wmLang="de";var debugModus=true;var testSite=false;var lastClickType=-1;var oldID=-1;var lastClickID=-1;var divisorClick=false;var readModus=false;var prevItem=0;var saveDataToFile=false;var newVersion=false;var mustBeSaved=false;var mustReload=false;var isGetSite=false;var client="";var isTempClient=false;var clientsList={};var reloadClient=false;var loadColorPicker=false;var picturesList=[];var picturesListError=false;var changeGlobal=false;var changeClient=false;var excludeFromRefresh=[];var tempExcludeFromRefresh=0;var specialTextVariables=["HTML","COLOR","DATE","TIME","HISTORIAN","TUNEIN"];var specialTextVariablesOnlypic=["COLOR","DATE","TIME"];var programsMap,functionsMap,roomsMap,favoritesMap,variablesMap,optionsMap,devicesMap,recognizeMap;var programsClientMap={},functionsClientMap={},roomsClientMap={},favoritesClientMap={},optionsClientMap={},variablesClientMap={},devicesClientMap={};var resultProgramsMap={},resultFunctionsMap={},resultRoomsMap={},resultFavoritesMap={},resultVariablesMap={},resultOptionsMap={},resultDevicesMap={};var theme,font,gfxClass;var loadedFont=["a"];var actColumn=1;var lastTime=-1;var isDialog=false;var twoPage;var dataListHeader="dataListHeader";var dataList="dataList";var prim="prim2";var page2=false;var today=new Date();var dateNow=(today.getDate()<10?"0"+today.getDate():today.getDate())+"."+(today.getMonth()+1<10?"0"+today.getMonth()+1:today.getMonth()+1)+"."+today.getFullYear();if(typeof String.prototype.endsWith!=="function"){String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1}}if(typeof String.prototype.startsWith!=="function"){String.prototype.startsWith=function(b,a){a=a||0;return this.indexOf(b,a)===a}}if(typeof String.prototype.trim!=="function"){(function(){var a=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(a,"")}})()}Array.prototype.max=function(){return Math.max.apply(null,this)};Array.prototype.min=function(){return Math.min.apply(null,this)};$.extend({keys:function(c){var b=[];$.each(c,function(a){b.push(a)});return b}});window.addEventListener("load",function(){window.applicationCache.addEventListener("updateready",function(){if(window.applicationCache.status===window.applicationCache.UPDATEREADY){window.applicationCache.swapCache();window.location.reload(true)}},false)},false);function checkrefreshPage(){var b=new Date();var a=b.getTime();if(lastTime!==-1){if(a-lastTime>60000){if(lastClickType===1||lastClickType===2||lastClickType===3||lastClickType===5||lastClickType===6){refreshPage(0)}refreshServiceMessages();lastTime=a}}else{lastTime=a}}function restartTimer(){var a=new Date();lastTime=a.getTime()}function createVerFile(){$.ajax({url:Base64.decode("aHR0cHM6Ly9nb28uZ2wvUTlvbUtB"),method:"GET",dataType:"JSONP",error:function(a,b){if(b==="error"){$.post("cgi/saveconfig.cgi",{name:"ver",text:webmaticVersion})}}})}function addVariableField(j,f,a,i,d,b){var h=unescape(a.value);var e=a.valueType;var g=a.valueUnit;var c="";if(d){c+=addReadonlyVariable(f,h,i,e,g,a.valueList,a.valueName0,a.valueName1,a.faktor?a.faktor:1)}else{if(e==="2"){c+=addSetBoolButtonList(j,f,h,a.valueName0,a.valueName1,g,i,true,b)}else{if(e==="4"){c+=addSetNumber(j,f,h,g,a.valueMin,a.valueMax,a.step?a.step:1,a.faktor?a.faktor:1,i,true,b)}else{if(e==="16"){c+=addSetValueList(j,f,h,a.valueList,g,i,true,b,a.listType?a.listType:"auto",false)}else{if(e==="20"&&g.toUpperCase()==="HTML"){c+=addHTML(j,f,h,i,!b)}else{if(e==="20"&&g.toUpperCase()==="HISTORIAN"){c+=addHistorianDiagram(j,f,h,i,!b)}else{if(e==="20"&&g.toUpperCase()==="TUNEIN"){c+=addTuneInRadio(j,f,h,i,!b)}else{if(e==="20"&&g.toUpperCase()==="COLOR"){c+=addColorPicker(j,f,h,i,b)}else{if(e==="20"&&g.toUpperCase()==="DATE"){c+=addDatePicker(j,f,h,i,b,"datebox")}else{if(e==="20"&&g.toUpperCase()==="TIME"){c+=addDatePicker(j,f,h,i,b,"timebox")}else{if(e==="20"){c+=addSetText(j,f,h,g,i,b)}else{c+=mapText("UNKNOWN_VAR_TYPE")+"!"}}}}}}}}}}}return c}function addSetButton(e,a,j,h,i,k,b,g,c,f){var d="";if(!k){d+="<p class='ui-li-desc'>"}d+="<a href='#' id='setButton_"+a+"' "+(f?"data-special='"+f+"' ":"")+"data-id='"+a+"' data-parent-id='"+e+"' data-refresh='"+g+"' data-value='"+h+"' class='ui-link ui-btn ui-btn-inline ui-shadow ui-corner-all "+(b?"ui-btn-active ":"")+(!c?"ui-state-disabled ":"")+"'>"+j+"</a>";if(!k){d+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+i+"</i> <span id='info_"+a+"' class='valueOK valueOK-"+theme+"'></span></p>"}return d}function addSetControlGroup(f,a,c,b,j,g,d,h,i){var e="";e+="<div data-role='controlgroup' data-type='horizontal'>";if(h){e+=h}e+=addSetButton(f,a,c,0,j,true,g===0,false,d);e+=addSetButton(f,a,"20%",0.2,j,true,g===0.2,false,d);e+=addSetButton(f,a,"40%",0.4,j,true,g===0.4,false,d);e+=addSetButton(f,a,"60%",0.6,j,true,g===0.6,false,d);e+=addSetButton(f,a,"80%",0.8,j,true,g===0.8,false,d);e+=addSetButton(f,a,b,1,j,true,g===1,false,d);if(i){e+=i}e+="</div>";return e}function addStartProgramButton(f,e,d,c,a){var b="<p class='ui-li-desc'><a href='#' "+(!a?"class='ui-link ui-btn ui-icon-gear ui-btn-icon-left ui-btn-inline ui-shadow ui-corner-all ui-state-disabled'":"data-role='button' data-inline='true' data-icon='gear'")+" id='startProgramButton_"+e+"' data-parent-id='"+f+"' data-id='"+e+"'>"+d+"</a></div>";b+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+c+"</i> <span id='info_"+e+"' class='valueOK valueOK-"+theme+"'></span></p>";return b}function addSetNumber(f,a,k,l,c,i,b,h,j,g,d,m){var e="<div class='ui-field-contain' id='mainNumber"+a+"'>";e+="<input type='range' value='"+k*h+"' min='"+c*h+"' max='"+i*h+"' step='"+b*h+"' data-factor='"+h+"' id='"+(m?"options":"")+"setValue_"+a+"' data-id='"+a+"' data-highlight='true' data-theme='"+theme+"'/>";e+=" ("+c*h+" - "+i*h+" <span id='unit_ "+a+"'>"+l+"</span>) ";e+="<a href='#' id='"+(m?"options":"")+"setButton_"+a+"' data-parent-id='"+f+"' data-id='"+a+"' data-refresh='"+g+"' "+(!d?"class='ui-link ui-btn ui-icon-check ui-btn-icon-left ui-btn-inline ui-shadow ui-corner-all ui-state-disabled'":"data-role='button' data-inline='true' data-icon='check'")+">"+mapText("SET")+"</a>";if(!m){e+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+j+"</i> <span id='info_"+a+"' class='valueOK valueOK-"+theme+"'></span>"}else{e+="&nbsp;<span id='optionsValueSpan"+a+"' style='font-weight: bolder; font-size: x-large;'>"+(k*h)+"</span>"}e+="</div>";return e}function addSetBoolButtonList(e,f,k,i,g,h,l,j,c,m){var d="<div class=ui-field-contain'>";d+="<div data-role='controlgroup' data-type='horizontal'>";var b="";if((k==="false"||k==="")&&!m){b="ui-btn-active"}var a=(!c?"class='ui-link ui-btn ui-btn-inline ui-shadow ui-corner-all ui-state-disabled "+b+"'":"class='"+b+"' data-role='button' data-inline='true'")+" id='"+(m?"options":"")+"setButton_"+f+"' data-parent-id='"+e+"' data-id='"+f+"' data-refresh='"+j+"'";d+="<a href='#' "+a+" data-value='false' data-theme='"+theme+"'>"+i+"</a>";b="";if(k==="true"||m){b="ui-btn-active"}a=(!c?"class='ui-link ui-btn ui-btn-inline ui-shadow ui-corner-all ui-state-disabled "+b+"'":"class='"+b+"' data-role='button' data-inline='true'")+"id='"+(m?"options":"")+"setButton_"+f+"' data-parent-id='"+e+"' data-id='"+f+"' data-refresh='"+j+"'";d+="<a href='#' "+a+" data-value='true' data-theme='"+theme+"'>"+g+"</a>";if(!m){d+="&nbsp;<span id='unit_ "+f+"'>"+h+"</span> ";d+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+l+"</i> <span id='info_"+f+"' class='valueOK valueOK-"+theme+"'></span>"}d+="</div>";d+="</div>";return d}function addSetValueList(c,f,j,b,h,k,i,a,d,l){var g=parseInt(j);var e=b.split(";");if(d==="small"||(e.length<6&&d!=="big")){return addSmallList(g,e,f,c,h,k,i,a,l)}else{return addBigList(g,e,f,c,h,k,i,a,l)}}function addSmallList(h,g,f,e,j,l,k,c,m){var d="<div class='ui-field-contain' id='mainNumber"+f+"'>";d+="<div data-role='controlgroup' data-type='horizontal'>";for(var b=0;b<g.length;b++){var a=(h===b?"ui-btn-active":"");d+="<a href='#' id='"+(m?"options":"")+"setButton_"+f+"' data-parent-id='"+e+"' data-id='"+f+"' data-refresh='"+k+"' data-value='"+b+"' "+(!c?"class='ui-link ui-btn ui-btn-inline ui-shadow ui-corner-all ui-state-disabled "+a+"'":"data-role='button' class='"+a+"' data-inline='true'")+">"+g[b]+"</a>"}d+="&nbsp;<span id='unit_ "+f+"'>"+j+"</span> ";d+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+l+"</i> <span id='info_"+f+"' class='valueOK valueOK-"+theme+"'></span>";d+="</div>";d+="</div>";return d}function addBigList(g,f,e,d,h,k,j,b,l){var c="<div data-role='controlgroup' data-type='horizontal' id='mainNumber"+e+"'>";c+="<select id='selector_"+e+"' data-theme='"+theme+"'>";for(var a=0;a<f.length;a++){if(g===a){c+="<option value='"+a+"' selected='selected'>"+f[a]+"</option>"}else{c+="<option value='"+a+"'>"+f[a]+"</option>"}}c+="</select>";c+="&nbsp;<span id='unit_ "+e+"'>"+h+"</span> <a href='#' id='"+(l?"options":"")+"setValueBigList_"+e+"' data-parent-id='"+d+"' data-id='"+e+"' data-refresh='"+j+"' "+(!b?"class='ui-link ui-btn ui-icon-check ui-btn-icon-left ui-btn-inline ui-shadow ui-corner-all ui-state-disabled'":"data-role='button' data-inline='true' data-icon='check'")+">&nbsp;</a>";c+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+k+"</i> <span id='info_"+e+"' class='valueOK valueOK-"+theme+"'></span>";c+="</div>";return c}function addSetText(g,d,e,f,c,a){var b="<div class=ui-field-contain'>";e=e.replace(/\"/g,"&quot;");if(e.length>40){b+="<textarea id='setValue_"+d+"' data-parent-id='"+g+"' data-id='"+d+"' style='width:20em; display:inline-block;'>"+e+"</textarea>"}else{b+="<input type='text' id='setValue_"+d+"' data-parent-id='"+g+"' data-id='"+d+"' value=\""+e+"\" style='width:20em; display:inline-block;'/>"}b+=" <span id='unit_ "+d+"'>"+f+"</span> <a href='#' id='setTextButton_"+d+"' data-parent-id='"+g+"' data-id='"+d+"' "+(!a?"class='ui-link ui-btn ui-icon-check ui-btn-icon-left ui-btn-inline ui-shadow ui-corner-all ui-state-disabled'":"data-role='button' data-inline='true' data-icon='check'")+">"+mapText("SET")+"</a>";b+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+c+"</i> <span id='info_"+d+"' class='valueOK valueOK-"+theme+"'></span>";b+="</div>";return b}function addReadonlyVariable(e,j,k,c,h,b,i,g,f){var a="";if(c==="2"){if(j==="true"){a=g}else{a=i}}else{if(c==="4"){a=parseFloat(j)*parseFloat(f)}else{if(c==="16"){var d=b.split(";");a=d[parseInt(j)]}else{a=j}}}if(c==="20"&&h.toUpperCase()==="HTML"){return addHTML("",e,j,k,true)}else{if(c==="20"&&h.toUpperCase()==="HISTORIAN"){return addHistorianDiagram("",e,j,k,true)}else{if(c==="20"&&h.toUpperCase()==="TUNEIN"){return addTuneInRadio("",e,j,k,true)}else{if(c==="20"&&h.toUpperCase()==="COLOR"){return"<p style='background-color: "+a+";'><img class='ui-img-"+theme+"' src='img/channels/unknown.png' style='max-height:20px'><span class='valueInfo valueInfo-"+theme+"'>"+a+" </span><i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+k+"</i></p>"}else{return"<p><img class='ui-img-"+theme+"' src='img/channels/unknown.png' style='max-height:20px'><span class='valueInfo valueInfo-"+theme+"'>"+a+" "+((c==="20"&&($.inArray(h.toUpperCase(),specialTextVariables)!==-1))?"":h)+" </span><i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+k+"</i></p>"}}}}}function addHTML(f,d,e,c,a){var b="<div class='ui-field-contain"+(a?"":" ui-grid-a")+"'>";b+="<div class='evalScript"+(a?"":" ui-block-a")+"' data-id='"+d+"'>"+e+"</div>";if(!a){b+="<div class='ui-block-b'><textarea id='setValue_"+d+"' data-parent-id='"+f+"' data-id='"+d+"' style='width:20em; display:inline-block;'>"+e+"</textarea>";b+="<a href='#' id='setTextButton_"+d+"' data-parent-id='"+f+"' data-id='"+d+"' data-role='button' data-inline='true' data-icon='check'>"+mapText("SET")+"</a>";b+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+c+"</i> <span id='info_"+d+"' class='valueOK valueOK-"+theme+"'></span>";b+="</div>"}b+="</div>";return b}function addHistorianDiagram(d,g,b,i,f){excludeFromRefresh.push(g.toString());if(!b){f=false;b=";;1D"}var c="";if(resultOptionsMap.ccu_historian===""){f=false;c=mapText("HISTORIAN_WARNING")}var h=b.split(";");if(h.length!==3){f=false;h=["","","1D"]}var e="<div class='ui-field-contain"+(f?"":" ui-grid-a")+"'>";if(f){e+="<div id='chart_"+g+"' style='min-width: 100px;' ></div>";$.ajax({url:resultOptionsMap.ccu_historian+"/query/json.gy?i="+h[0]+"&d="+h[2],method:"GET",dataType:"JSONP",contentType:"application/json",jsonpCallback:"historian_callback",success:function(k){if($("#chart_"+g).length){reloadHistorianChart(g,k)}else{$("#"+dataList).one("create",function(){reloadHistorianChart(g,k)})}},error:function(k,l){log("Request Historian chart failed: "+l,2)}})}else{if(c!==""){e+="<div class='ui-block-g'>"+c+"</div>"}e+="<div class='ui-block-f'>CCU-Historian-ID</div>";e+="<div class='ui-block-g'>";e+="<input type='text' placeholder='18,19,20...' id='hisHistorianID_"+g+"' value=\""+h[0]+'" />';e+="</div>";e+="<div class='ui-block-f'>Homematic-ID</div>";e+="<div class='ui-block-g'>";e+="<input type='text' placeholder='8918,8919,8920...' id='hisHMID_"+g+"' value=\""+h[1]+'" />';e+="</div>";e+="<div class='ui-block-f'>"+mapText("HISTORIAN_DURATION")+"</div>";e+="<div class='ui-block-g'>";e+="<div data-role='controlgroup' data-type='horizontal'>";var j=h[2].slice(0,-1);var a=h[2].substr(h[2].length-1);e+="<input type='number' min='1' max='100' id='hisDuration_"+g+"' value=\""+j+"\" data-wrapper-class='controlgroup-textinput ui-btn'/>";e+="<select id='hisSelector_"+g+"' data-theme='"+theme+"'>";e+="<option value='s' "+(a==="s"?"selected='selected'":"")+">"+mapText("TIME_SEC_PLURAL")+"</option>";e+="<option value='m' "+(a==="m"?"selected='selected'":"")+">"+mapText("TIME_MIN_PLURAL")+"</option>";e+="<option value='h' "+(a==="h"?"selected='selected'":"")+">"+mapText("TIME_H_PLURAL")+"</option>";e+="<option value='D' "+(a==="D"?"selected='selected'":"")+">"+mapText("TIME_DAY_PLURAL")+"</option>";e+="<option value='W' "+(a==="W"?"selected='selected'":"")+">"+mapText("TIME_W_PLURAL")+"</option>";e+="<option value='M' "+(a==="M"?"selected='selected'":"")+">"+mapText("TIME_MON_PLURAL")+"</option>";e+="<option value='Y' "+(a==="Y"?"selected='selected'":"")+">"+mapText("TIME_Y_PLURAL")+"</option>";e+="</select>";e+="</div>";e+="</div>";e+="<div class='ui-block-f'>";e+="<a href='#' id='saveHistorianData_"+g+"' data-parent-id='"+d+"' data-id='"+g+"' data-role='button' data-inline='true' data-icon='check'>"+mapText("SET")+"</a>";e+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+i+"</i> <span id='info_"+g+"' class='valueOK valueOK-"+theme+"'></span>";e+="</div>"}e+="</div>";return e}function reloadHistorianChart(b,a){$.jqplot("chart_"+b,[a],{axes:{xaxis:{renderer:$.jqplot.DateAxisRenderer,tickRenderer:$.jqplot.CanvasAxisTickRenderer,tickOptions:{formatString:"%#d %b %#H:%M",angle:-60}}},series:[{lineWidth:1,markerOptions:{style:"square"}}],highlighter:{show:true,sizeAdjust:5.5},cursor:{zoom:true,show:true},grid:{backgroundColor:"#F4F4F4"},animated:true})}function addTuneInRadio(f,d,e,c,a){excludeFromRefresh.push(d.toString());if(!e||!e.startsWith("http")){a=false}var b="<div class='editButton'>";b+="<a href='#' class='ui-btn ui-btn-inline ui-icon-"+(a?"edit":"eye")+" ui-btn-icon-notext ui-corner-all' name='"+(a?"edit":"show")+"TuneIn' data-id='"+d+"' data-val='"+e+"' data-parent-id='"+f+"' data-vor-date='"+c+"' />";b+="</div>";b+="<div class='ui-field-contain ui-grid-a' id='tuneInField_"+d+"'>";b+=a?getTuneIn(f,d,e,c):editTuneIn(f,d,e,c);b+="</div>";return b}function getTuneIn(g,d,f,c){if(!f||!f.startsWith("http")){return editTuneIn(g,d,f,c)}var e="";if(f.indexOf("topicId")>-1){e="t"+f.substr(f.lastIndexOf("=")+1,f.length)}else{e=f.substr(f.lastIndexOf("-")+1,f.length)}if(e.indexOf("/")===-1){e+="/"}var a="100px";if(e.startsWith("p")){a="350px"}else{if(e.startsWith("t")){a="110px"}}var b="<div class='ui-block-a'>";b+="<iframe src='http://tunein.com/embed/player/"+e+"' style='width:100%;height:"+a+";' scrolling='no' frameborder='no'></iframe>";b+="</div>";return b}function editTuneIn(e,c,d,b){var a="<div class='ui-block-a'>TuneIn-URL</div>";a+="<div class='ui-block-b'>";a+="<input type='text' placeholder='http://tunein.com/radio/Farstuff-The-Internet-of-Things-Podcast-p575427/' id='tuneInURL_"+c+"' value=\""+d+'" />';a+="</div>";a+="<div class='ui-block-a'>";a+="<a href='#' id='saveTuneInRadioData_"+c+"' data-parent-id='"+e+"' data-id='"+c+"' data-value='"+d+"' data-role='button' data-inline='true' data-icon='check'>"+mapText("SET")+"</a>";a+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+b+"</i> <span id='info_"+c+"' class='valueOK valueOK-"+theme+"'></span>";a+="</div>";return a}function addColorPicker(f,d,e,c,a){var b="<div class='ui-field-contain'>";b+="<input type='text' class='colorPicker' id='setValue_"+d+"' data-parent-id='"+f+"' data-id='"+d+"' value=\""+e+"\" style='width:20em; display:inline-block;'/>";b+="<a href='#' id='setTextButton_"+d+"' data-parent-id='"+f+"' data-id='"+d+"' "+(!a?"class='ui-link ui-btn ui-icon-check ui-btn-icon-left ui-btn-inline ui-shadow ui-corner-all ui-state-disabled'":"data-role='button' data-inline='true' data-icon='check'")+">"+mapText("SET")+"</a>";b+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+c+"</i> <span id='info_"+d+"' class='valueOK valueOK-"+theme+"'></span>";b+="</div>";loadColorPicker=true;return b}function addDatePicker(g,e,f,d,a,b){var c="<div class='ui-field-contain'>";c+="<input type='text' data-role='datebox' data-theme='"+theme+"' id='setValue_"+e+"' data-parent-id='"+g+"' data-id='"+e+"' value=\""+f+"\" data-datebox-mode='"+b+"'/>";c+="<a href='#' id='setTextButton_"+e+"' data-parent-id='"+g+"' data-id='"+e+"' "+(!a?"class='ui-link ui-btn ui-icon-check ui-btn-icon-left ui-btn-inline ui-shadow ui-corner-all ui-state-disabled'":"data-role='button' data-inline='true' data-icon='check'")+">"+mapText("SET")+"</a>";c+="<i class='last-used-time ui-li-desc' "+(resultOptionsMap.show_lastUsedTime?"":"style='display: none;'")+">"+d+"</i> <span id='info_"+e+"' class='valueOK valueOK-"+theme+"'></span>";c+="</div>";return c}function openOnlyPicDialog(b,a,c){$("#functionName").text(b);$("#functionContent").html(a);isDialog=true;$(document.body).one("pagebeforeshow","#page1",function(){isDialog=false;refreshPage(0)});$.mobile.changePage("#dialog");$("#dialog").enhanceWithin();if(typeof c==="function"){c()}}function getDivisorSelectbox(f,b,h,g,i){var a=getMap(f);var d="";d+="<select name='saveDivisor' data-type='"+f+"' data-key='"+f+"_divisor' data-id='"+h+"' data-theme='"+theme+"'>";var c=i&&i[f+"_divisor"];if(g){var e=(b==="unsorted")?mapText("UNSORTED"):a.divisors[b]["name"];d+="<option value=''"+(!c?"selected='selected'":"")+">Global: "+e+"</option>"}else{d+="<option value='unsorted'></option>"}$.each(a.divisors,function(k,j){if($.isNumeric(k)){k=parseInt(k)}var l=false;if(g){l=c&&i[f+"_divisor"]===k}else{l=b===k}d+="<option value='"+k+"' "+(l?"selected='selected'":"")+">"+j.name+"</option>"});d+="</select>";return d}function addDivisor(h,f){var a=getMap(f);var c={};if(resultOptionsMap.default_sort_manually&&optionsMap[f+"_divisor"]){a=recalculatePositions(a,f,true)}$.each(a.divisors,function(k,l){var i="<li id='list"+k+"' data-id='"+k+"'>";i+="<div class='ui-grid-b'>";i+="<div class='ui-block-a'>";i+="<input type='text' name='editName' data-id='"+k+"' data-type='"+f+"Divisor' value='"+l.name+"' />";i+="</div>";i+="<div class='ui-block-b'>";i+="<a href='#' name='deleteDivider' data-id='"+k+"' data-type='"+f+"Divisor' data-role='button' data-inline='true'>"+mapText("DELETE")+"</a>";i+="</div>";i+="<div class='ui-block-c'>";if(resultOptionsMap.default_sort_manually){i+="<div style='float: right;'>";i+="<input type='hidden' name='position' id='position"+k+"' data-id='"+k+"' data-type='"+f+"Divisor' value='"+l.position+"' data-last='"+(h===l.position)+"'/>";i+="<a href='#' class='ui-btn ui-btn-inline ui-icon-carat-u ui-btn-icon-notext ui-corner-all";if(l.position<=1){i+=" ui-state-disabled' style='display: none;"}i+="' name='setUp' id='setUp"+k+"' data-id='"+k+"' />";i+="<a href='#' class='ui-btn ui-btn-inline ui-icon-carat-d ui-btn-icon-notext ui-corner-all";if(l.position>=h){i+=" ui-state-disabled' style='display: none;"}i+="' name='setDown' id='setDown"+k+"' data-id='"+k+"' />";i+="</div>"}i+="</div>";i+="</div>";i+="</li>";if(resultOptionsMap.default_sort_manually){c[parseInt(l.position)]=i}else{c[l.name.toLowerCase()]=i}});var g;if(resultOptionsMap.default_sort_manually){g=Object.keys(c).sort(function(k,i){return k-i})}else{g=Object.keys(c).sort()}var j="";var e=g.length;for(var d=0;d<e;d++){var b=g[d];j+=c[b]}return j}function createClientMenuOptions(e){var c="";if(!optionsMap[e+"_divisor"]){c+="<div class='ui-block-f text-right'>";c+="<span>"+mapText(e)+" "+mapText("SHOW")+"</span>";c+="</div>";c+="<div class='ui-block-g'>";c+="<div data-role='controlgroup' data-type='horizontal'>";var d="";var b="";var a="";if(!(e in optionsClientMap)){d="class='ui-btn-active'"}else{if(optionsClientMap[e]){b="class='ui-btn-active'"}else{a="class='ui-btn-active'"}}c+="<a href='#' name='saveClientOption' data-key='"+e+"' data-value='none' data-role='button' data-inline='true' "+d+">"+mapText("NOT_SELECTED")+"</a>";c+="<a href='#' name='saveClientOption' data-key='"+e+"' data-value='true' data-role='button' data-inline='true' "+b+">"+mapText("YES")+"</a>";c+="<a href='#' name='saveClientOption' data-key='"+e+"' data-value='false' data-role='button' data-inline='true' "+a+">"+mapText("NO")+"</a>";c+="</div>";c+="</div>"}else{var f=getMap(e);c+="<div class='ui-block-divisor-top'>";c+=mapText("DIVIDE")+" "+mapText(e);c+="</div>";$.each(f.divisors,function(i,k){c+="<div class='ui-block-f text-right'>";c+="<span>"+k.name+" "+mapText("SHOW")+"</span>";c+="</div>";c+="<div class='ui-block-g'>";c+="<div data-role='controlgroup' data-type='horizontal'>";var j="";var h="";var g="";if(!((e+i) in optionsClientMap)){j="class='ui-btn-active'"}else{if(optionsClientMap[e+i]){h="class='ui-btn-active'"}else{g="class='ui-btn-active'"}}c+="<a href='#' name='saveClientOption' data-key='"+e+i+"' data-value='none' data-role='button' data-inline='true' "+j+">"+mapText("NOT_SELECTED")+"</a>";c+="<a href='#' name='saveClientOption' data-key='"+e+i+"' data-value='true' data-role='button' data-inline='true' "+h+">"+mapText("YES")+"</a>";c+="<a href='#' name='saveClientOption' data-key='"+e+i+"' data-value='false' data-role='button' data-inline='true' "+g+">"+mapText("NO")+"</a>";c+="</div>";c+="</div>"});c+="<div class='ui-block-divisor-bottom'>";c+="</div>"}return c}function createGlobalMenuOptions(d){var b="";if(!optionsMap[d+"_divisor"]){b+="<div class='ui-block-f text-right'>";b+="<span>"+mapText(d)+" "+mapText("SHOW")+"</span>";b+="</div>";b+="<div class='ui-block-g'>";b+="<div data-role='controlgroup' data-type='horizontal'>";var c="";var a="";if(optionsMap[d]){c="class='ui-btn-active'"}else{a="class='ui-btn-active'"}b+="<a href='#' name='saveGlobalOption' data-key='"+d+"' data-value='true' data-role='button' data-inline='true' "+c+">"+mapText("YES")+"</a>";b+="<a href='#' name='saveGlobalOption' data-key='"+d+"' data-value='false' data-role='button' data-inline='true' "+a+">"+mapText("NO")+"</a>";b+="</div>";b+="</div>"}else{var e=getMap(d);b+="<div class='ui-block-divisor-top'>";b+=mapText("DIVIDE")+" "+mapText(d);b+="</div>";$.each(e.divisors,function(g,i){b+="<div class='ui-block-f text-right'>";b+="<span>"+i.name+" "+mapText("SHOW")+"</span>";b+="</div>";b+="<div class='ui-block-g'>";b+="<div data-role='controlgroup' data-type='horizontal'>";var h="";var f="";if(optionsMap[d+g]){h="class='ui-btn-active'"}else{f="class='ui-btn-active'"}b+="<a href='#' name='saveGlobalOption' data-key='"+d+g+"' data-value='true' data-role='button' data-inline='true' "+h+">"+mapText("YES")+"</a>";b+="<a href='#' name='saveGlobalOption' data-key='"+d+g+"' data-value='false' data-role='button' data-inline='true' "+f+">"+mapText("NO")+"</a>";b+="</div>";b+="</div>"});b+="<div class='ui-block-divisor-bottom'>";b+="</div>"}return b}function getSelectColapsedOptions(c,a){var b="";if(!optionsMap[c+"_divisor"]){b+="<option value='"+c+"' "+(a===c?"selected='selected'":"")+">"+mapText(c)+"</option>"}else{var d=getMap(c);$.each(d.divisors,function(e,f){b+="<option value='"+c+e+"' "+(a===(c+e)?"selected='selected'":"")+">"+f.name+"</option>"})}return b}function changeTheme(a){$("body, .ui-popup-screen").removeClass(function(c,b){return(b.match(/(^|\s)ui-overlay-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("ui-overlay-"+a);$(".ui-page").removeClass(function(c,b){return(b.match(/(^|\s)ui-page-theme-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("ui-page-theme-"+a).attr("data-theme",a);$(".ui-header").removeClass(function(c,b){return(b.match(/(^|\s)ui-bar-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("ui-bar-"+a).attr("data-theme",a);$(".ui-content").removeClass(function(c,b){return(b.match(/(^|\s)ui-body-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("ui-body-"+a).attr("data-theme",a);$(".ui-collapsible-set, .ui-listview").removeClass(function(c,b){return(b.match(/(^|\s)ui-group-theme-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("ui-group-theme-"+a).attr("data-theme",a);$(".ui-btn").removeClass(function(c,b){return(b.match(/(^|\s)ui-btn-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("ui-btn-"+a).attr("data-theme",a);$(".valueNoError").removeClass(function(c,b){return(b.match(/(^|\s)valueNoError-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("valueNoError-"+a);$(".valueInfo").removeClass(function(c,b){return(b.match(/(^|\s)valueInfo-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("valueInfo-"+a);$(".valueWarning").removeClass(function(c,b){return(b.match(/(^|\s)valueWarning-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("valueWarning-"+a);$(".valueError").removeClass(function(c,b){return(b.match(/(^|\s)valueError-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("valueError-"+a);$(".valueOK").removeClass(function(c,b){return(b.match(/(^|\s)valueOK-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("valueOK-"+a);$(".buttonService, #popupDiv").filter(function(){return this.className.match(/\bvalueService-/)}).removeClass(function(c,b){return(b.match(/(^|\s)valueService-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("valueService-"+a);$("img").removeClass(function(c,b){return(b.match(/(^|\s)ui-img-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("ui-img-"+a);$(".control-set").removeClass(function(c,b){return(b.match(/(^|\s)control-set-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("control-set-"+a);$(".onlyPic-player").removeClass(function(c,b){return(b.match(/(^|\s)onlyPic-player-(\S{3}|\S{1})/g)||[]).join(" ")}).addClass("onlyPic-player-"+a);if(!isGetSite){$("#page2").attr("data-theme",a);$("#page2").find("[data-theme]").attr("data-theme",a);$("#dialog").attr("data-theme",a);$("#dialog").find("[data-theme]").attr("data-theme",a)}theme=a}function changeMenuGfx(a){if(a==="small"){$(".menu").removeClass("ui-li-thumb").addClass("ui-li-icon");$(".ui-li-has-thumb").removeClass("ui-li-has-thumb").addClass("ui-li-has-icon");$("#listFavorites").listview("refresh");$("#listRooms").listview("refresh");$("#listFunctions").listview("refresh");$("#listOther").listview("refresh")}if(a==="large"){$(".menu").removeClass("ui-li-icon").addClass("ui-li-thumb");$(".ui-li-has-icon").removeClass("ui-li-has-icon").addClass("ui-li-has-thumb");$("#listFavorites").listview("refresh");$("#listRooms").listview("refresh");$("#listFunctions").listview("refresh");$("#listOther").listview("refresh")}gfxClass=a}function changeTwoPage(a){if(a){$("#prim").hide();$("#second").removeClass("content-secondary").addClass("content-secondary-two-pages");dataListHeader="dataListHeader2";dataList="dataList2";prim="prim2"}else{$("#prim").show();$("#second").removeClass("content-secondary-two-pages").addClass("content-secondary");dataListHeader="dataListHeader";dataList="dataList";prim="prim"}twoPage=a}function changeNumberOfColumns(a){if(a!==actColumn){$("#dataList, #dataList2").removeClass(function(c,b){return(b.match(/(^|\s)column-(\d)/g)||[]).join(" ")}).addClass("column-"+a);actColumn=a}}function changeFont(c){var d="";var b="";switch(c){case"a":b="sans-serif";break;case"b":b="KochFraktur";d="themes/fonts/KochFraktur/KochFraktur.ttf";break;case"c":b="PlanetBenson";d="themes/fonts/Planet_benson/planetbe.ttf";break;case"d":b="ActionMan";d="themes/fonts/Action_Man/Action_Man.ttf";break;case"e":b="Amadeus";d="themes/fonts/Amadeus/Amadeus.ttf";break;case"f":b="Vamp";d="themes/fonts/Vamp/RIKY2vamp.ttf";break;case"g":b="HennyPenny";d="themes/fonts/HennyPenny/HennyPenny-Regular.otf";break;case"h":b="Kavoon";d="themes/fonts/Anglican/AnglicanText.ttf";break;case"i":b="Nosifer";d="themes/fonts/Nosifer/NosiferCaps-Regular.ttf";break;case"j":b="Pacifico";d="themes/fonts/Pacifico/Pacifico.ttf";break;case"k":b="Sixties";d="themes/fonts/Sixties/Sixties.ttf";break;case"l":b="Crackman";d="themes/fonts/Crackman/CRACKMAN.ttf";break}setFont=function(e){$("body, input, select, textarea, button, .ui-btn").css("font-family",e)};if($.inArray(c,loadedFont)===-1){var a=new Font();a.onload=function(){setFont(b)};a.fontFamily=b;a.src=d}else{setFont(b)}loadedFont.push(c);font=c}function addUnsorted(c){var b={};b.name=mapText("UNSORTED");b.position=999;var a=c.divisors;a.unsorted=b;c.divisors=a}function removeUnsorted(b){var a=b.divisors;delete a.unsorted;b.divisors=a}function recalculatePositions(b,l,j){var d={};var a=0;var e=0;var g=j?b.divisors:b;$.each(g,function(k,o){if(k==="date"||k==="size"||k==="divisors"){return}a++;var i=parseInt(o.position);if(i>e){e=i}d[i]=k});if(e!==a){var n;n=Object.keys(d).sort(function(k,i){return k-i});var h=n.length;var m=0;for(var f=0;f<h;f++){var c=n[f];m++;if(j){b.divisors[d[c]]["position"]=m}else{b.size=a;b[d[c]]["position"]=m}}l=setMap(l,b);localStorage.setItem("webmatic"+l+"Map",JSON.stringify(getMap(l)));$.post("cgi/saveconfig.cgi",{name:l,text:JSON.stringify(getMap(l))})}return b}function setDraggable(a,b){$(".draggable").draggable({snap:"container"+b+a,containment:"container"+b+a,scroll:false,opacity:0.5,stack:".draggable",stop:function(c,d){}})}function getPicKey(i,f,a,j){var c=i;if(f==="variables"){var h=unescape(a.value);var d=a.valueType;if(!j){if(d==="4"){h=parseFloat(h);var b=$.grep(picturesList,function(l){var k=new RegExp("^"+i,"i");return l.trim().match(k)});var g=parseFloat(a.valueMin);if(typeof b!=="undefined"&&b.length>0){$.each(b,function(l,m){var k=parseFloat(m.split("_")[1]);if(k<=h&&k>g){g=k}})}h=g;c+="_"+h}else{if(d==="2"){c+="_"+(h==="true")}else{if(d!=="20"){c+="_"+h}}}}else{var d=a.valueType;if(d==="2"){c+="_true"}else{if(d==="4"){c+="_"+a.valueMin}else{if(d==="16"){var e=a.valueList;c+="_"+e[0]}}}}}return c}function getPicFloatList(b){var a=$.grep(picturesList,function(e){var d=new RegExp("^"+b,"i");return e.trim().match(d)});var c=[];$.each(a,function(d,e){c.push(e.substr(b.length+1,e.length))});return c.sort(function(e,d){return parseFloat(e)-parseFloat(d)})}function createImgFloatList(d,b){var a=getPicFloatList(String(d));var c="<div data-role='controlgroup' id='imgFloatList"+d+"'>";$.each(a,function(e,f){c+="<a href='#' id='imgFloat"+d+"_"+f+"' name='setImgFloat' data-id='"+d+"' data-val='"+f+"' class='ui-btn ui-mini ui-corner-all'>"+(f*b)+"</a>"});c+="</div>";return c}function log(a,c,b){if(debugModus){if(c===0){console.info(a)}else{if(c===1){console.warn(a)}else{if(c===2){console.error(a)}else{if(c===3){if($("#errorsDebugger").length){$("#errorsDebugger").append("<li>"+b+": "+a+"</li>")}else{alert(b+": "+a);errorsDebugger.push("<li>"+b+": "+a+"</li>")}}else{console.log(a)}}}}}}function getDateFromString(d){var a=d.substring(0,2);var f=d.substring(3,5)-1;var e=d.substring(6,10);var c=d.substring(11,13);var b=d.substring(14,16);var g=d.substring(17,19);return new Date(e,f,a,c,b,g)}function getResultMap(a){switch(a){case"variables":return resultVariablesMap;case"programs":return resultProgramsMap;case"favorites":return resultFavoritesMap;case"rooms":return resultRoomsMap;case"functions":return resultFunctionsMap;case"devices":return resultDevicesMap}}function setResultMap(a,b){switch(a){case"variables":resultVariablesMap=b;break;case"programs":resultProgramsMap=b;break;case"favorites":resultFavoritesMap=b;break;case"rooms":resultRoomsMap=b;break;case"functions":resultFunctionsMap=b;break;case"devices":resultDevicesMap=b;break}}function getClientMap(a){switch(a){case"variables":return variablesClientMap;case"programs":return programsClientMap;case"favorites":return favoritesClientMap;case"rooms":return roomsClientMap;case"functions":return functionsClientMap;case"devices":return devicesClientMap;case"config":return optionsClientMap}}function setClientMap(a,b){switch(a){case"variables":variablesClientMap=b;break;case"programs":programsClientMap=b;break;case"favorites":favoritesClientMap=b;break;case"rooms":roomsClientMap=b;break;case"functions":functionsClientMap=b;break;case"devices":devicesClientMap=b;break}}function getMap(a){switch(a){case"variables":return variablesMap;case"programs":return programsMap;case"favorites":return favoritesMap;case"rooms":return roomsMap;case"functions":return functionsMap;case"devices":return devicesMap;case"config":return optionsMap}}function setMap(a,b){switch(a){case"variables":variablesMap=b;break;case"variablesDivisor":variablesMap.divisors=b;a="variables";break;case"programs":programsMap=b;break;case"programsDivisor":programsMap.divisors=b;a="programs";break;case"favorites":favoritesMap=b;break;case"favoritesDivisor":favoritesMap.divisors=b;a="favorites";break;case"rooms":roomsMap=b;break;case"roomsDivisor":roomsMap.divisors=b;a="rooms";break;case"functions":functionsMap=b;break;case"functionsDivisor":functionsMap.divisors=b;a="functions";break;case"devices":devicesMap=b;break;case"config":optionsMap=b;break}return a}function loadLocalStorageMap(a,b){switch(a){case"variables":variablesMap=JSON.parse(localStorage.getItem("webmatic"+a+"Map"));break;case"programs":programsMap=JSON.parse(localStorage.getItem("webmatic"+a+"Map"));break;case"favorites":favoritesMap=JSON.parse(localStorage.getItem("webmatic"+a+"Map"));break;case"rooms":roomsMap=JSON.parse(localStorage.getItem("webmatic"+a+"Map"));break;case"functions":functionsMap=JSON.parse(localStorage.getItem("webmatic"+a+"Map"));break;case"devices":devicesMap=JSON.parse(localStorage.getItem("webmatic"+a+"Map"+b));break}}function createOneMap(a,b,c){switch(a){case"config":$.each(optionsMap,function(d,e){if(d in optionsClientMap){resultOptionsMap[d]=optionsClientMap[d]}else{resultOptionsMap[d]=e}});if(b){if(resultOptionsMap[b]===c){checkAndChange(b,c)}}break;case"variables":$.each(variablesMap,function(d,e){if(d in variablesClientMap){var f={};$.each(e,function(g,h){if(!(g in variablesClientMap[d])){f[g]=h}else{f[g]=variablesClientMap[d][g]}});resultVariablesMap[d]=f}else{resultVariablesMap[d]=e}});break;case"programs":$.each(programsMap,function(d,e){if(d in programsClientMap){var f={};$.each(e,function(g,h){if(!(g in programsClientMap[d])){f[g]=h}else{f[g]=programsClientMap[d][g]}});resultProgramsMap[d]=f}else{resultProgramsMap[d]=e}});break;case"favorites":$.each(favoritesMap,function(d,e){if(d in favoritesClientMap){var f={};$.each(e,function(g,h){if(!(g in favoritesClientMap[d])){f[g]=h}else{f[g]=favoritesClientMap[d][g]}});resultFavoritesMap[d]=f}else{resultFavoritesMap[d]=e}});break;case"rooms":$.each(roomsMap,function(d,e){if(d in roomsClientMap){var f={};$.each(e,function(g,h){if(!(g in roomsClientMap[d])){f[g]=h}else{f[g]=roomsClientMap[d][g]}});resultRoomsMap[d]=f}else{resultRoomsMap[d]=e}});break;case"functions":$.each(functionsMap,function(d,e){if(d in functionsClientMap){var f={};$.each(e,function(g,h){if(!(g in functionsClientMap[d])){f[g]=h}else{f[g]=functionsClientMap[d][g]}});resultFunctionsMap[d]=f}else{resultFunctionsMap[d]=e}});break;case"devices":$.each(devicesMap,function(d,e){if(d in devicesClientMap){var f={};$.each(e,function(g,h){if(!(g in devicesClientMap[d])){f[g]=h}else{f[g]=devicesClientMap[d][g]}});resultDevicesMap[d]=f}else{resultDevicesMap[d]=e}});break}}function isReadOnlyVariable(b){var c=b.indexOf("(");if(c!==-1){var d=b.indexOf(")",c);if(d!==-1){var e=b.substring(c+1,d);var f=e.split(",");if(f.length>=1){var a=f[0].toLowerCase();if(a==="r"){return false}else{if(a==="w"){return true}}}}}return"none"}function checkOperate(a){if(!readModus){return true}if(a==="none"){return !(resultOptionsMap.systemvar_readonly&&readModus)}return a}function isReadOnly(b){if(!readModus){return false}var a="";var f=[];var c=b.indexOf("(");if(c!==-1){var d=b.indexOf(")",c);if(d!==-1){var e=b.substring(c+1,d);f=e.split(",");if(f.length>=1){a=f[0].toLowerCase()}}}if(a==="h"||a==="dk"||a==="d"||a==="g"){return false}if(resultOptionsMap.systemvar_readonly&&readModus){return a!=="w"}return a==="r"}var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var k,h,f,j,g,e,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a},decode:function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!==64){a=a+String.fromCharCode(h)}if(d!==64){a=a+String.fromCharCode(f)}}a=Base64._utf8_decode(a);return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}};function getTimeDiffString(b,c){var d=(getDateFromString(c)-getDateFromString(b))/1000;var a;if(d<0){return""}else{if(d<60){a=Math.floor(d+0.5);return"("+mapText("TIME_PREFIX")+" "+a+" "+(a===1?mapText("TIME_SEC_SINGULAR"):mapText("TIME_SEC_PLURAL"))+" "+mapText("TIME_SUFFIX")+")"}else{if(d<60*60){a=Math.floor(d/60+0.5);return"("+mapText("TIME_PREFIX")+" "+a+" "+(a===1?mapText("TIME_MIN_SINGULAR"):mapText("TIME_MIN_PLURAL"))+" "+mapText("TIME_SUFFIX")+")"}else{if(d<60*60*24){a=Math.floor(d/(60*60)+0.5);return"("+mapText("TIME_PREFIX")+" "+a+" "+(a===1?mapText("TIME_H_SINGULAR"):mapText("TIME_H_PLURAL"))+" "+mapText("TIME_SUFFIX")+")"}else{if(d<60*60*24*30.5){a=Math.floor(d/(60*60*24)+0.5);return"("+mapText("TIME_PREFIX")+" "+a+" "+(a===1?mapText("TIME_DAY_SINGULAR"):mapText("TIME_DAY_PLURAL"))+" "+mapText("TIME_SUFFIX")+")"}else{if(d<60*60*24*30.5*12){a=Math.floor(d/(60*60*24*30.5)+0.5);return"("+mapText("TIME_PREFIX")+" "+a+" "+(a===1?mapText("TIME_MON_SINGULAR"):mapText("TIME_MON_PLURAL"))+" "+mapText("TIME_SUFFIX")+")"}else{a=Math.floor(d/(60*60*24*30.5*12)+0.5);if(a<40){return"("+mapText("TIME_PREFIX")+" "+a+" "+(a===1?mapText("TIME_Y_SINGULAR"):mapText("TIME_Y_PLURAL"))+" "+mapText("TIME_SUFFIX")+")"}}}}}}}return""}function checkAndChange(a,b){if(a==="default_theme"&&b!==theme){changeTheme(b)}else{if(a==="default_font"&&b!==font){changeFont(b)}else{if(a==="default_menugfxsize"&&b!==gfxClass){changeMenuGfx(b)}else{if(a==="two_sites"&&b!==twoPage){changeTwoPage(b)}else{if(a==="columns"){changeNumberOfColumns(b,true)}else{if(a==="favorites"||a==="rooms"||a==="functions"||a==="variables"||a==="programs"||a==="others"){if(b&&$("#"+a+"MainMenu").is(":hidden")){$("#"+a+"MainMenu").fadeIn()}else{if(!b&&!$("#"+a+"MainMenu").is(":hidden")){$("#"+a+"MainMenu").fadeOut()}}}}}}}}};